---
import { getCollection } from 'astro:content'
import Category from '@/components/ui/category.astro'
import SectionHeading from './section-heading.astro'
import Block from './block.astro'

const posts = (
  await getCollection('posts', ({ data }) => {
    return data.draft !== true
  })
).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
---

<Block>
  <SectionHeading> Recent posts </SectionHeading>
  <ul class="mt-2 grid gap-6">
    {
      posts.map((post) => {
        const { title, category, description } = post.data
        return (
          <li>
            <a href={`/post/${post.slug}/`} class="block rounded-3xl">
              <h2 class="font-cartridgeregular text-tn-green hover:text-tn-teal0 text-lg">
                {category && <Category>{category}:</Category>} {title}
              </h2>
              <p class="text-md font-rethink text-tn-text">{description}</p>
            </a>
          </li>
        )
      })
    }
  </ul>
</Block>
