---
import { getCollection } from 'astro:content'
import PostLayout from '@/layouts/post-layout.astro'
import Prose from '@/components/ui/prose.astro'
import Back from '@/components/ui/back.astro'

export async function getStaticPaths() {
  const posts = await getCollection('posts')
  const published = posts.filter((post) => !post.data.draft)
  return published.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }))
}

const { post } = Astro.props
const { Content } = await post.render()
const { title, category, description } = post.data
---

<PostLayout {description} {title}>
  <Prose element="article" {title} {category}>
    <Content />
  </Prose>
  <Back />
</PostLayout>
